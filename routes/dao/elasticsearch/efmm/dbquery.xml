<?xml version="1.0"?>
<queryList>
  <dashboard>
    <query id='selectDashboardGageData'><![CDATA[
      {
        "index" : [##index##],
        "type"  : #type#,
        "body" : {
          "size" : 10000,
          "sort" : [{ "dtTransmitted" : "asc" }, { "cid" : "asc" }],
          "_source" : ["data.dtSensed", "cid", "data.availability", "data.performance", "data.quality", "data.overall_oee"],
          "query" : {
            "bool": {
              "should" : [
                {"range" : { "dtTransmitted" : 
                  { "gte" : #gte0#, "lte" : #lte0# }}},
                {"range" : { "dtTransmitted" : 
                  { "gte" : #gte1#, "lte" : #lte1# }}},
                {"range" : { "dtTransmitted" : 
                  { "gte" : #gte2#, "lte" : #lte2# }}},
                {"range" : { "dtTransmitted" : 
                  { "gte" : #gte3#, "lte" : #lte3# }}},
                {"range" : { "dtTransmitted" : 
                  { "gte" : #gte4#, "lte" : #lte4# }}},
                {"range" : { "dtTransmitted" : 
                  { "gte" : #gte5#, "lte" : #lte5# }}},
                {"range" : { "dtTransmitted" : 
                  { "gte" : #gte6#, "lte" : #lte6# }}}
              ]
            }
          }
        }
      }
    ]]></query>
    <query id='selectDashboardAggsData'><![CDATA[
      {
        "index" : #index#,
        "type"  : #type#,
        "body" : {          
          "sort" : { "dtTransmitted": { "order" : "asc" } },
          "query" : {
            "bool" : {
              "must" : {
                "range" : {
                  "dtTransmitted" : {
                    "gte" : #gte#,
                    "lte" : #lte#
                  }
                }
              }
            }
          },
          "aggs" : {
            "group_by_state" : {
              "terms": {
                "field": "dtTransmitted"
              },
              "aggs" : {
                "availability_time" : {
                  "sum" : {
                    "field": "data.planned_production_time"
                  }
                },
                "down_time" : {
                  "sum" : {
                    "field": "data.total_down_time"
                  }
                },
                "running_time" : {
                  "sum" : {
                    "field": "data.operating_time"
                  }
                },
                "expected_unit" : {
                  "sum" : {
                    "field": "data.total_expected_unit"
                  }
                },
                "produce_unit" : {
                  "sum" : {
                    "field": "data.total_pieces"
                  }
                },
                "good_unit" : {
                  "sum" : {
                    "field" : "data.total_accept_pieces"
                  }
                },
                "ng_unit" : {
                  "sum" : {
                    "field": "data.total_reject_pieces"
                  }
                }
              }
            }
          }
        }
      }
    ]]></query>
    <query id='selectDashboardDetail'><![CDATA[
      {
        "index" : #index#,
        "type"  : #type#,
        "body" : {          
          "sort" : [{ "dtTransmitted" : "desc" },{ "cid" : "asc" }],
          "size" : 5,
          "_source" : ["data.dtSensed", "cid", "data.availability", "data.performance", "data.quality", "data.overall_oee"],
          "query" : {
            "bool": {
              "filter" : {
                "range" : {
                  "dtTransmitted" : {
                    "gte" : #gte#,
                    "lte" : #lte#
                  }
                }
              }
            }
          }
        }
      }
    ]]></query>
    <query id='selectDashboardInfo'><![CDATA[
      {
        "index" : #index#,
        "type"  : #type#,
        "body" : {                    
          "query" : {
            "bool": {
              "filter" : {
                "term" : { "data.dtSensed" : #date# }
              },
              "must" : { 
                "match" : { "cid" : #cid# }
              }
            }
          }
        }
      }
    ]]></query>
  </dashboard>  
  <scheduler>
    <query id='selectApplicationInfo'><![CDATA[
      {
        "index" : #index#,
        "type" : #type#,
        "body" : {
      }
    }]]></query>
    <query id='insertApplicationInfo'><![CDATA[
      {
        body : #BODY#
      }
    ]]></query>
  </scheduler>
  <analysis>
    <query id='selectNotchingOeeRaw'><![CDATA[
      {
        "index" : #INDEX#,
        "type"  : #TYPE#,
        "body" : {
          "size": 100000,
          "sort": { "dtTransmitted": { "order" : "asc" } },
          "query" : {
            "bool" : {
              "must": [ {"match_all" : {} } ],
              "filter" : {
                "range" : {
                  "dtTransmitted" : { "gte" : #START#, "lte" : #END# }
                }
              }
            }
          }
        
        }
      }
    ]]></query>
    <query id='selectStackingStatus'><![CDATA[
      {
        "index" : #INDEX#,
        "type"  : #TYPE#,
        "body" : {
          "_source" : [ "data" ],
          "sort": { "dtTransmitted": { "order" : "asc" } },
          "query" : {
            "bool" : {
              "must": [ 
                {"term" : {"cid" : #CID#}},
                {"term" : {"sensorType" : #STYPE#}}
              ],
              "filter" : {
                "range" : {
                  "dtTransmitted" : { "gte" : #START#, "lte" : #END# }
                }
              }
            }
          }
        }
      }
    ]]></query>
  </analysis>
</queryList>